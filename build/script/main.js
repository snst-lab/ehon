!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./build/script/",n(n.s=11)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(1),r=n(5);!function(e){e.start=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){return[2,new Promise(function(e,n){r.fileReader({url:"ehon.json",type:"GET",async:!0,data:""}).then(function(n){var o,i=JSON.parse(n.responseText);o=[i.config,i.param,i.css],t.config=o[0],t.param=o[1],t.css=o[2],e()}).catch(function(e){n(e.responseText)})})]})})}}(o||(o={})),t.readSetting=o.start},function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return i}),n.d(t,"__assign",function(){return r}),n.d(t,"__rest",function(){return a}),n.d(t,"__decorate",function(){return c}),n.d(t,"__param",function(){return s}),n.d(t,"__metadata",function(){return l}),n.d(t,"__awaiter",function(){return u}),n.d(t,"__generator",function(){return d}),n.d(t,"__exportStar",function(){return f}),n.d(t,"__values",function(){return m}),n.d(t,"__read",function(){return p}),n.d(t,"__spread",function(){return v}),n.d(t,"__await",function(){return h}),n.d(t,"__asyncGenerator",function(){return y}),n.d(t,"__asyncDelegator",function(){return g}),n.d(t,"__asyncValues",function(){return w}),n.d(t,"__makeTemplateObject",function(){return S}),n.d(t,"__importStar",function(){return _}),n.d(t,"__importDefault",function(){return b});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&(n[o[i]]=e[o[i]])}return n}function c(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){return function(n,o){t(n,o,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{s(o.next(e))}catch(e){r(e)}}function c(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,c)}s((o=o.apply(e,t||[])).next())})}function d(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}}function f(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function m(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=n.apply(e,t||[]),r=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(e){i[e]&&(o[e]=function(t){return new Promise(function(n,o){r.push([e,t,n,o])>1||c(e,t)})})}function c(e,t){try{(n=i[e](t)).value instanceof h?Promise.resolve(n.value.v).then(s,l):u(r[0][2],n)}catch(e){u(r[0][3],e)}var n}function s(e){c("next",e)}function l(e){c("throw",e)}function u(e,t){e(t),r.shift(),r.length&&c(r[0][0],r[0][1])}}function g(e){var t,n;return t={},o("next"),o("throw",function(e){throw e}),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,i){t[o]=e[o]?function(t){return(n=!n)?{value:h(e[o](t)),done:"return"===o}:i?i(t):t}:i}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=m(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise(function(o,i){(function(e,t,n,o){Promise.resolve(o).then(function(t){e({value:t,done:n})},t)})(o,i,(t=e[n](t)).done,t.value)})}}}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function b(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i,r,a=n(0),c=n(3);!function(e){e.className="canvas",e.dom=new c.DOMX("."+e.className),e.element=e.dom.el,e.z=Number(e.element.style.zIndex),e.aspectRatio=e.element.offsetHeight/e.element.offsetWidth,e.paper=document.querySelector(".paper"),e.paperSound=document.querySelector(".paper-sound")}(o=t.Canvas||(t.Canvas={})),function(e){e.header=document.querySelector("header"),e.headerTitle=document.querySelector(".header-title"),e.headerPage=document.querySelector(".header-page"),e.footer=document.querySelector("footer"),e.volume=document.querySelector(".volume"),e.show=function(){e.header.style.top="0"},e.hide=function(){a.config.live&&function t(n){switch(n){case 120:if(!a.config.live)return;e.header.style.top="-5vh"}window.requestAnimationFrame(function(){return t(n+1)})}(0)},e.volumeOn=function(){a.config.volumeOn=!0,e.volume.textContent="volume_up"},e.volumeOff=function(){a.config.volumeOn=!1,e.volume.textContent="volume_off";for(var t=0;t<r._.length;t++)r._[t].Sounds.forEach(function(e){return e.element.pause()})}}(i=t.Frame||(t.Frame={})),function(e){function t(t){if(e.now<t&&t<e._.length)[e._[e.now].Camera].concat(e._[e.now].Images,e._[e.now].Texts).forEach(function(e){e.running=!1}),[e._[t].Camera].concat(e._[t].Images,e._[t].Texts).forEach(function(e){e.running=!1,e.transition(e.state[0])}),n(e.now,t),e.now=t;else if(e.now<t&&t>=e._.length)[e._[e.now].Camera].concat(e._[e.now].Images,e._[e.now].Texts).forEach(function(e){e.running=!1}),[e._[0].Camera].concat(e._[0].Images,e._[0].Texts).forEach(function(e){e.transition(e.state[0])}),n(e.now,0),e.now=0;else if(t>=0&&t<e.now)[e._[e.now].Camera].concat(e._[e.now].Images,e._[e.now].Texts).forEach(function(e){e.running=!1}),[e._[t].Camera].concat(e._[t].Images,e._[t].Texts).forEach(function(e){e.transition(e.state[0])}),function(t,n){var i=e._[t].dom.el,r=e._[n].dom.el,c=i.cloneNode(!0),s=i.cloneNode(!0),l=r.cloneNode(!0),u=r.cloneNode(!0);s.style.cssText="backface-visibility:hidden;clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);",c.style.cssText="backface-visibility:hidden;clip-path: polygon(0 0%, 50% 0, 50% 100%, 0 100%);border-left: solid 5px rgb(200,200,200);",l.style.cssText="backface-visibility:hidden;clip-path: polygon(0 0%, 50% 0, 50% 100%, 0 100%);display:none;",u.style.cssText="backface-visibility:hidden;clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);transform-origin:50% 50%; transform: perspective(1000px) rotateY(-180deg);border-right:solid 5px rgb(200,200,200);",o.dom.el.appendChild(l),o.dom.el.appendChild(u),o.dom.el.appendChild(c),o.dom.el.appendChild(s),a.config.volumeOn&&o.paperSound.play().catch(function(e){return console.log(e)});i.style.display="none",r.style.display="none",function e(t){switch(t){case 10:o.paper.style.cssText="filter:opacity(100%);z-index:"+(o.z-1),c.style.cssText="transition: 0.8s ease;backface-visibility:hidden;clip-path: polygon(0 0%, 50% 0, 50% 100%, 0 100%);transform-origin:0% 50%; transform: perspective(1000px) rotateY(180deg);border-left: solid 5px rgb(200,200,200);",u.style.cssText="transition: 0.8s ease;backface-visibility:hidden;clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);transform-origin:50% 50%; transform: perspective(1000px) rotateY(0deg);border-right: solid 5px rgb(200,200,200);";break;case 25:s.remove(),c.remove(),l.style.cssText="backface-visibility:hidden;clip-path: polygon(0 0%, 50% 0, 50% 100%, 0 100%);display:block;";break;case 45:u.remove(),l.remove(),r.style.display="block",o.paper.style.cssText="filter:opacity(0%);z-index:"+(o.z-1);var n=document.createEvent("HTMLEvents");return n.initEvent("sceneChange",!0,!1),void document.dispatchEvent(n)}window.requestAnimationFrame(function(){return e(t+1)})}(0)}(e.now,t),e.now=t;else if(t<0)return;i.headerPage.textContent=e.now+"　ページ",i.show(),i.hide()}function n(t,n){var i=e._[t].dom.el,r=e._[n].dom.el,c=i.cloneNode(!0),s=i.cloneNode(!0),l=r.cloneNode(!0),u=r.cloneNode(!0);c.style.cssText="backface-visibility:hidden;clip-path: polygon(0 0%, 50% 0, 50% 100%, 0 100%);",s.style.cssText="backface-visibility:hidden;clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);border-right:solid 5px rgb(200,200,200);",l.style.cssText="backface-visibility:hidden;clip-path: polygon(0 0%, 50% 0, 50% 100%, 0 100%);transform-origin:50% 50%; transform: perspective(1000px) rotateY(180deg);border-left:solid 5px rgb(200,200,200);",u.style.cssText="backface-visibility:hidden;clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);display:none;",o.dom.el.appendChild(l),o.dom.el.appendChild(u),o.dom.el.appendChild(c),o.dom.el.appendChild(s),a.config.volumeOn&&o.paperSound.play().catch(function(e){return console.log(e)}),i.style.display="none",r.style.display="none",function e(t){switch(t){case 10:o.paper.style.cssText="filter:opacity(100%);z-index:"+(o.z+1),s.style.cssText="transition: 0.8s ease;backface-visibility:hidden;clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);transform-origin:0% 50%; transform: perspective(1000px) rotateY(-180deg);border-right: solid 5px rgb(200,200,200);",l.style.cssText="transition: 0.8s ease;backface-visibility:hidden;clip-path: polygon(0 0%, 50% 0, 50% 100%, 0 100%);transform-origin:50% 50%; transform: perspective(1000px) rotateY(0deg);border-left: solid 5px rgb(200,200,200);";break;case 25:s.remove(),c.remove(),u.style.cssText="backface-visibility:hidden;clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);display:block;";break;case 45:u.remove(),l.remove(),r.style.display="block",o.paper.style.cssText="filter:opacity(0%);z-index:"+(o.z+1);var n=document.createEvent("HTMLEvents");return n.initEvent("sceneChange",!0,!1),void document.dispatchEvent(n)}window.requestAnimationFrame(function(){return e(t+1)})}(0)}e.className="scene",e.now=0,e._=[],e.init=function(){e._.forEach(function(e,t){e.dom.el.style.display=0===t?"":"none"}),e.now=0;var t=document.createEvent("HTMLEvents");t.initEvent("sceneChange",!0,!1),document.dispatchEvent(t)},e.change=t,e.add=function(t,n,i,r){var a=e._.length;e._.push({className:e.className+a,dom:new c.DOM("<div class='"+e.className+a+" "+e.className+"'><div class='base-layer' style='z-index:"+o.z+"' onclick='baseLayerClick(event);'></div></div>"),Camera:t,Images:n,Texts:i,Sounds:r})},e.remove=function(n){1!==e._.length&&(t(n>0?n-1:n+1),e._[n].dom.el.remove(),e._.splice(n,1),e._.forEach(function(e,t){t>=n&&([e.Camera].concat(e.Images,e.Texts).forEach(function(e){return e.scene=e.scene-1}),e.dom.el.classList.remove("scene"+(t+1)),e.dom.el.classList.add("scene"+t))}))}}(r=t.Scene||(t.Scene={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(1);!function(e){var t=function(){function e(e){if(this.parser=new DOMParser,"string"!=typeof e||/[<>]/.test(e))if("string"==typeof e&&/[<>]/.test(e)){var t=this.parser.parseFromString(e,"text/html").body.childNodes,n=[].slice.call(t);if(1===n.filter(function(e){return!(e instanceof Text)}).length)this.el=n[0];else{this.el=document.createElement("div");for(var o=document.createDocumentFragment(),i=[0,n.length],r=i[0],a=i[1];r<a;r++)o.appendChild(n[r]);this.el.appendChild(o)}}else e instanceof Element||e instanceof DocumentFragment?this.el=e:this.el=document.createDocumentFragment();else this.el=document.querySelector(e)}return e.prototype.append=function(e){if("string"==typeof e&&this.el){for(var t=document.createDocumentFragment(),n=this.parser.parseFromString(e,"text/html").body.childNodes,o=[].slice.call(n),i=[0,o.length],r=i[0],a=i[1];r<a;r++)t.appendChild(o[r]);return this.el.appendChild(t),!1}return e instanceof Element||e instanceof DocumentFragment?(this.el.appendChild(e),!1):this.el},e.prototype.prepend=function(e){if("string"==typeof e){for(var t=document.createDocumentFragment(),n=this.parser.parseFromString(e,"text/html").body.childNodes,o=[].slice.call(n),i=[0,o.length],r=i[0],a=i[1];r<a;r++)t.appendChild(o[r]);return this.el.insertBefore(t,this.el.firstChild),!1}return e instanceof Element||e instanceof DocumentFragment?(this.el.insertBefore(e,this.el.firstChild),!1):this.el},e.prototype.rewrite=function(e){if("string"==typeof e){for(var t=document.createDocumentFragment(),n=this.parser.parseFromString(e,"text/html").body.childNodes,o=[].slice.call(n),i=[0,o.length],r=i[0],a=i[1];r<a;r++)t.appendChild(o[r]);for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);return this.el.appendChild(t),!1}if(e instanceof Element||e instanceof DocumentFragment){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild);return this.el.appendChild(e),!1}return this.el},e.prototype.on=function(e,t){this.el.addEventListener(e,t,!1)},e.prototype.off=function(e,t){this.el.removeEventListener(e,t,!1)},e}();e.Main=t;var n=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.prototype.touch=function(e,t){var n=this,o=void 0!==t?1/t:.05;this.el.addEventListener("touchstart",function(t){t.cancelable&&t.preventDefault(),n.el.removeEventListener("touchstart",function(){},!1);var i=t.changedTouches[0].pageX,r=t.changedTouches[0].pageY;n.el.addEventListener("touchend",function(t){n.el.removeEventListener("touchend",function(){},!1),t.changedTouches[0].pageX>i-window.screen.width*o&&t.changedTouches[0].pageX<i+window.screen.width*o&&t.changedTouches[0].pageY>r-window.screen.height*o&&t.changedTouches[0].pageY<r+window.screen.height*o&&e(t),i=0,r=0})},!1)},t.prototype.swipe=function(e,t,n){var o=this,i=void 0!==n?1/n:.1;switch(e){case"left":this.el.addEventListener("touchstart",function(e){e.cancelable&&e.preventDefault(),o.el.removeEventListener("touchstart",function(){return null},!1);var n=e.changedTouches[0].pageX;o.el.addEventListener("touchend",function(e){o.el.removeEventListener("touchend",function(){return null},!1),e.changedTouches[0].pageX<n-window.screen.width*i&&t(e),n=0})},!1);break;case"right":this.el.addEventListener("touchstart",function(e){o.el.removeEventListener("touchstart",function(){return null},!1),e.cancelable&&e.preventDefault();var n=e.changedTouches[0].pageX;o.el.addEventListener("touchend",function(e){o.el.removeEventListener("touchend",function(){return null},!1),e.changedTouches[0].pageX>n+window.screen.width*i&&t(e),n=window.screen.width})},!1);break;case"up":this.el.addEventListener("touchstart",function(e){e.cancelable&&e.preventDefault(),o.el.removeEventListener("touchstart",function(){return null},!1);var n=e.changedTouches[0].pageY;o.el.addEventListener("touchend",function(e){o.el.removeEventListener("touchend",function(){return null},!1),e.changedTouches[0].pageY<n-window.screen.height*i&&t(e),n=0})},!1);break;case"down":this.el.addEventListener("touchstart",function(e){e.cancelable&&e.preventDefault(),o.el.removeEventListener("touchstart",function(){return null},!1);var n=e.changedTouches[0].pageY;o.el.addEventListener("touchend",function(e){o.el.removeEventListener("touchend",function(){return null},!1),e.changedTouches[0].pageY>n+window.screen.height*i&&t(e),n=window.screen.height})},!1);break;default:return}},t.prototype.inview=function(e,t){t=t||{root:null,rootMargin:"0%",threshold:[.5]},new IntersectionObserver(function(t){for(var n=0,o=t;n<o.length;n++){var i=o[n];if(i.isIntersecting){var r=i;r.srcElement=i.target,e(r)}}},t).observe(this.el)},t.prototype.outview=function(e,t){t=t||{root:null,rootMargin:"0%",threshold:[.5]},new IntersectionObserver(function(t){for(var n=0,o=t;n<o.length;n++){var i=o[n];if(!i.isIntersecting){var r=i;r.srcElement=i.target,e(r)}}},t).observe(this.el)},t}(t);e.Extention=n}(o||(o={})),t.DOM=o.Main,t.DOMX=o.Extention},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(0),r=n(2),a=n(6),c=n(7),s=n(9),l=n(10);!function(e){var n=function(){function e(){}return e.setActiveStyle=function(e){3!==e.types&&(this.removeActiveStyle(e),e.element.style.outlineColor=i.css.active.outlineColor,e.element.style.outlineStyle=i.css.active.outlineStyle,e.element.style.outlineWidth=i.css.active.outlineWidth,0!==e.types&&(e.element.style.resize=i.css.resize.resize,e.element.style.overflow=i.css.resize.overflow,e.element.style.cursor=i.css.resize.cursor),[e.now].concat(e.state).forEach(function(e){e.option="\n\t\t\t\t\t"+e.option+";\n\t\t\t\t\toutline-color:"+i.css.active.outlineColor+";\n\t\t\t\t\toutline-style:"+i.css.active.outlineStyle+";\n\t\t\t\t\toutline-width:"+i.css.active.outlineWidth+";\n\t\t\t\t\tresize:"+i.css.resize.resize+";\n\t\t\t\t\toverflow:"+i.css.resize.overflow+";\n\t\t\t\t\tcursor:"+i.css.resize.cursor+";\n\t\t\t\t\t"}))},e.removeActiveStyle=function(e){3!==e.types&&(e.element.style.outlineColor="",e.element.style.outlineStyle="",e.element.style.outlineWidth="",e.element.style.resize="",e.element.style.overflow="",e.element.style.cursor="",[e.now].concat(e.state).forEach(function(e){e.option=e.option.replace("outline-color:"+i.css.active.outlineColor+";","").replace("outline-style:"+i.css.active.outlineStyle+";","").replace("outline-width:"+i.css.active.outlineWidth+";","").replace("resize:"+i.css.resize.resize+";","").replace("overflow:"+i.css.resize.overflow+";","").replace("cursor:"+i.css.resize.cursor+";","")}))},e}();e.CSS=n;var o=function(){function e(){}return e.prototype.activate=function(e,o){i.config.live||(this.type=o,r.Scene._[r.Scene.now].Images.concat(r.Scene._[r.Scene.now].Texts,[r.Scene._[r.Scene.now].Camera]).forEach(function(t){t.className!==e&&n.removeActiveStyle(t)}),t.Active=this.select(e),void 0!==t.Active&&(2===t.Active.types&&(t.Active.element.contentEditable="true"),new Promise(function(e){a.PalletKeyframe.render(),a.PalletTrigger.render(),e()}).then(function(){void 0!==t.Active&&n.setActiveStyle(t.Active)}).catch(function(e){return console.log(e)})))},e.prototype.release=function(){void 0!==t.Active&&(n.removeActiveStyle(t.Active),1===t.Active.types&&(t.Active.element.style.pointerEvents="none",t.Active.pointer="none"),2===t.Active.types&&(t.Active.element.style.pointerEvents="none",t.Active.pointer="none",t.Active.element.contentEditable="false"),a.PalletActive.title.dom.el.textContent="",a.PalletKeyframe.delay.dom.el.textContent="",a.PalletKeyframe.iteration.dom.el.textContent="",t.Active=void 0,a.PalletKeyframe.clear(),a.PalletTrigger.hide(),a.PalletTrigger.clear())},e.prototype.recover=function(){r.Scene._[r.Scene.now].Images.concat(r.Scene._[r.Scene.now].Texts,[r.Scene._[r.Scene.now].Camera]).forEach(function(e){e.touchable&&(e.element.style.pointerEvents="auto",e.pointer="auto")})},e.prototype.select=function(e){switch(this.type){case 1:return r.Scene._[r.Scene.now].Images.filter(function(t){return t.className===e})[0];case 2:return r.Scene._[r.Scene.now].Texts.filter(function(t){return t.className===e})[0];case 3:return r.Scene._[r.Scene.now].Sounds.filter(function(t){return t.className===e})[0];case 0:return r.Scene._[r.Scene.now].Camera;default:return}},e}();e.Selector=o;var u=function(){function e(){}return e.prototype.translate=function(e,t,n,o){if(3!==e.types){var r={src:e.now.src,x:e.now.x+t,y:e.now.y+n,z:e.now.z+~~o,width:e.now.width,aspectRatio:e.now.aspectRatio,rotate:e.now.rotate,scale:e.now.scale,blur:e.now.blur,opacity:e.now.opacity,chroma:e.now.chroma,light:e.now.light,duration:i.param.animation.defaultDuration,option:e.now.option};e.transition(r)}},e.prototype.rotate=function(e,t){if(3!==e.types){var n={src:e.now.src,x:e.now.x,y:e.now.y,z:e.now.z,width:e.now.width,aspectRatio:e.now.aspectRatio,rotate:e.now.rotate+~~t,scale:e.now.scale,blur:e.now.blur,opacity:e.now.opacity,chroma:e.now.chroma,light:e.now.light,duration:i.param.animation.defaultDuration,option:e.now.option};e.transition(n)}},e.prototype.scale=function(e,t){if(1===e.types||2===e.types){var n={src:e.now.src,x:e.now.x,y:e.now.y,z:e.now.z,width:e.now.width,aspectRatio:e.now.aspectRatio,rotate:e.now.rotate,scale:e.now.scale+t,blur:e.now.blur,opacity:e.now.opacity,chroma:e.now.chroma,light:e.now.light,duration:i.param.animation.defaultDuration,option:e.now.option};e.transition(n)}},e.prototype.blur=function(e,t){if(1===e.types||2===e.types){var n={src:e.now.src,x:e.now.x,y:e.now.y,z:e.now.z,width:e.now.width,aspectRatio:e.now.aspectRatio,rotate:e.now.rotate,scale:e.now.scale,blur:Math.max(e.now.blur+t,0),opacity:e.now.opacity,chroma:e.now.chroma,light:e.now.light,duration:i.param.animation.defaultDuration,option:e.now.option};e.transition(n)}},e.prototype.opacity=function(e,t){if(1===e.types||2===e.types){var n={src:e.now.src,x:e.now.x,y:e.now.y,z:e.now.z,width:e.now.width,aspectRatio:e.now.aspectRatio,rotate:e.now.rotate,scale:e.now.scale,blur:e.now.blur,opacity:~~Math.max(Math.min(e.now.opacity+t,100),0),chroma:e.now.chroma,light:e.now.light,duration:i.param.animation.defaultDuration,option:e.now.option};e.transition(n)}},e.prototype.chroma=function(e,t){if(1===e.types||2===e.types){var n={src:e.now.src,x:e.now.x,y:e.now.y,z:e.now.z,width:e.now.width,aspectRatio:e.now.aspectRatio,rotate:e.now.rotate,scale:e.now.scale,blur:e.now.blur,opacity:e.now.opacity,chroma:~~Math.max(e.now.chroma+t,0),light:e.now.light,duration:i.param.animation.defaultDuration,option:e.now.option};e.transition(n)}},e.prototype.light=function(e,t){if(1===e.types||2===e.types){var n={src:e.now.src,x:e.now.x,y:e.now.y,z:e.now.z,width:e.now.width,aspectRatio:e.now.aspectRatio,rotate:e.now.rotate,scale:e.now.scale,blur:e.now.blur,opacity:e.now.opacity,chroma:e.now.chroma,light:~~Math.max(e.now.light+t,0),duration:i.param.animation.defaultDuration,option:e.now.option};e.transition(n)}},e}();e.Transform=u;var d=function(){function e(){}return e.prototype.addNewScene=function(){var e=r.Scene._.length,t={src:"",x:i.param.camera.initialX,y:i.param.camera.initialY,z:i.param.camera.initialZ,width:0,aspectRatio:0,rotate:0,scale:0,blur:0,opacity:0,chroma:0,light:0,duration:i.param.animation.defaultDuration,option:""},n=new c.ComponentCamera({scene:e,types:0,className:"camera",title:"Camera",touchable:!0,pointer:"auto",float:!0,trigger:[],delay:0,iteration:1,state:[t],now:t,running:!1,element:null});r.Scene.add(n,[],[],[]),r.Scene.change(e),r.Canvas.dom.append(r.Scene._[e].dom.el)},e.prototype.CanvasDrop=function(e,t,n){var o=e/(r.Canvas.element.offsetWidth+r.Canvas.element.offsetLeft)*100,i=t/(r.Canvas.element.offsetHeight+r.Canvas.element.offsetTop)*100;null!==n&&(/.png|.gif|.jpg|jpeg|.PNG|.GIF|.JPG|.JPEG|.svg|.SVG$/.test(n.name)?this.CanvasDropComponent(o,i,1,n,null):/.wav|.mp3|.ogg$/.test(n.name)?this.CanvasDropComponent(o,i,3,n,null):this.CanvasDropComponent(o,i,2,n,null))},e.prototype.CanvasDropComponent=function(e,n,o,s,u){var d,f,m;if(null===u&&null!==s){switch(o){case 1:f={src:s.name,x:(r.Scene._[r.Scene.now].Camera.now.z/i.param.image.initialZ-1)*(e-.5*i.param.image.defaultSize)+r.Scene._[r.Scene.now].Camera.now.x+(2-r.Scene._[r.Scene.now].Camera.now.z/i.param.image.initialZ)*i.param.camera.vanishingX,y:(r.Scene._[r.Scene.now].Camera.now.z/i.param.image.initialZ-1)*(n-i.param.image.defaultSize*i.param.image.aspectRatio*.5)+r.Scene._[r.Scene.now].Camera.now.y+(2-r.Scene._[r.Scene.now].Camera.now.z/i.param.image.initialZ)*i.param.camera.vanishingY,z:i.param.image.initialZ,width:i.param.image.defaultSize,aspectRatio:i.param.image.aspectRatio,rotate:0,scale:1,blur:0,opacity:100,chroma:100,light:100,duration:i.param.animation.defaultDuration,option:""};break;case 2:f={src:s.name,x:e,y:n,z:i.param.text.initialZ,width:i.param.text.defaultSize,aspectRatio:i.param.text.aspectRatio,rotate:0,scale:1,blur:0,opacity:100,chroma:100,light:100,duration:i.param.animation.defaultDuration,option:""};break;case 3:f={src:s.name,x:0,y:0,z:0,width:0,aspectRatio:0,rotate:0,scale:0,blur:0,opacity:0,chroma:0,light:0,duration:i.param.animation.defaultDuration,option:""};break;default:return}d={scene:r.Scene.now,types:o,className:"",title:"",touchable:!0,pointer:"auto",float:1===o,trigger:[],iteration:1,delay:0,state:[f],now:f,running:!1,element:null}}else null!==u&&(f={src:u.now.src,x:e,y:n,z:u.now.z,width:u.now.width,aspectRatio:u.now.aspectRatio,rotate:u.now.rotate,scale:u.now.scale,blur:u.now.blur,opacity:u.now.opacity,chroma:u.now.chroma,light:u.now.light,duration:i.param.animation.defaultDuration,option:u.now.option},d={scene:u.scene,types:o,className:"",title:u.title,touchable:!0,pointer:"auto",float:u.float,trigger:u.trigger,iteration:u.iteration,delay:u.delay,state:[f],now:f,running:!1,element:null});1===o?(m=new c.ComponentImage(d,r.Scene._[r.Scene.now].Camera.now),r.Scene._[r.Scene.now].Images.push(m),r.Scene._[r.Scene.now].dom.append(m.element),t.EditorSelector.activate(m.className,1)):2===o?(m=new c.ComponentText(d,r.Scene._[r.Scene.now].Camera.now),r.Scene._[r.Scene.now].Texts.push(m),r.Scene._[r.Scene.now].dom.append(m.element),t.EditorSelector.activate(m.className,2)):3===o&&(m=new c.ComponentSound(d),r.Scene._[r.Scene.now].Sounds.push(m),r.Scene._[r.Scene.now].dom.append(m.element),t.EditorSelector.activate(m.className,3),new l.SoundPlayer.Register(t.Active)),a.PalletKeyframe.render(),a.PalletLayer.render(t.EditorSelector),a.PalletTrigger.render()},e.prototype.ComponentClick=function(e,n){switch(n){case"camera":t.EditorSelector.activate(e,0);break;case"image":t.EditorSelector.activate(e,1);break;case"text":t.EditorSelector.activate(e,2);break;default:return}},e.prototype.CameraClick=function(e){t.EditorSelector.recover(),t.EditorSelector.activate(e,0)},e.prototype.PushStateClick=function(){void 0!==t.Active&&(3!==t.Active.types&&(1===t.Active.state.length&&new s.Animation.Register(t.Active),t.Active.transition(t.Active.now)),n.removeActiveStyle(t.Active),t.Active.state.push(t.Active.now),a.PalletKeyframe.render(),n.setActiveStyle(t.Active))},e.prototype.ShowLayerClick=function(){a.PalletLayer.opened?a.PalletLayer.hide():(a.PalletLayer.render(t.EditorSelector),a.PalletLayer.show())},e.prototype.ShowTriggerClick=function(){a.PalletTrigger.opened?a.PalletTrigger.hide():a.PalletTrigger.show()},e.prototype.PlayClick=function(){void 0!==t.Active&&(3!==t.Active.types?new s.Animation.Play(t.Active):t.Active.running?(t.Active.element.pause(),t.Active.running=!1):new l.SoundPlayer.Play(t.Active))},e.prototype.BaseLayerClick=function(){t.EditorSelector.recover()},e}();e.EventHandler=d}(o=t.Editor||(t.Editor={})),t.EditorCSS=o.CSS,t.EditorSelector=new o.Selector,t.EditorTransform=new o.Transform,t.EditorEventHandler=new o.EventHandler},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(1);!function(e){e.read=function(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(n){return t=new XMLHttpRequest,"POST"===e.type?[2,new Promise(function(n,o){t.open("POST",e.url,e.async),t.onload=function(){4===t.readyState&&t.status>=200&&t.status<400?n(t):o(t)},t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.send(e.data)})]:[2,new Promise(function(n,o){t.open("GET",e.url,e.async),t.onload=function(){4===t.readyState&&t.status>=200&&t.status<400?n(t):o(t)},t.send()})]})})}}(o||(o={})),t.fileReader=o.read},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(3),r=n(0),a=n(2),c=n(4);!function(e){e.dom=document.querySelector(".pallet");var n=function(){function e(){}return e.className="live-edit-toggle",e.dom=new i.DOM(".live-edit-toggle"),e}();e.LiveEditToggle=n;var o=function(){function e(){}return e.className="scene-changer",e.forward=new i.DOM(".scene-changer-forward"),e.back=new i.DOM(".scene-changer-back"),e.current=new i.DOM(".scene-changer-current"),e.add=new i.DOM(".scene-changer-add"),e.remove=new i.DOM(".scene-changer-remove"),e}();e.SceneChanger=o;var s=function(){function e(){}return e.className="camera",e.dom=new i.DOM(".camera"),e}();e.Camera=s;var l=function(){function e(){}return e.className="save",e.dom=new i.DOM(".save"),e}();e.Save=l;var u=function(){function e(){}var t,n,o;return e.title=((t=function(){return function(){}}()).className="active-title-value",t.dom=new i.DOM(".active-title-value"),t),e.touch=((n=function(){return function(){}}()).className="active-touch-switch",n.dom=new i.DOM(".active-touch-switch"),n),e.float=((o=function(){return function(){}}()).className="active-float-switch",o.dom=new i.DOM(".active-float-switch"),o),e}();e.Active=u;var d=function(){function e(){}return e.show=function(){e.dom.el.style.left="-15vw",e.button.el.style.color="rgb(0,200,180)",f.hide(),e.opened=!0},e.hide=function(){e.dom.el.style.left="0",e.button.el.style.color="",e.opened=!1},e.render=function(t){var n=new i.DOM;n.append('<div class="layer-index">Layer</div>'),n.append("\n\t\t\t<div class='layer-component layer-component0'>\n\t\t\t\t\t<i class='layer-component-icon material-icons'>videocam</i>\n\t\t\t\t\t<div class='layer-component-title layer-component-title0'>"+a.Scene._[a.Scene.now].Camera.title+"</div>\n\t\t\t</div>\n\t\t\t");for(var o=[0,a.Scene._[a.Scene.now].Images.length],r=o[0],c=o[1];r<c;r++)n.append("\n\t\t\t\t\t<div class='layer-component layer-component"+(r+1)+"'>\n\t\t\t\t\t\t<i class='layer-component-icon material-icons'>insert_photo</i>\n\t\t\t\t\t\t<div class='layer-component-title layer-component-title"+(r+1)+"'>"+a.Scene._[a.Scene.now].Images[r].title+"</div>\n\t\t\t\t\t\t<i class='layer-component-remove layer-component-remove"+(r+1)+" material-icons'>delete</i>\n\t\t\t\t\t</div>\n\t\t\t\t\t");var s=[0,a.Scene._[a.Scene.now].Images.length,a.Scene._[a.Scene.now].Texts.length],l=(r=s[0],s[1]);for(c=s[2];r<c;r++)n.append("\n\t\t\t\t\t<div class='layer-component layer-component"+(r+1+l)+"'>\n\t\t\t\t\t\t<i class='layer-component-icon material-icons'>text_fields</i>\n\t\t\t\t\t\t<div class='layer-component-title layer-component-title"+(r+1+l)+"'>"+a.Scene._[a.Scene.now].Texts[r].title+"</div>\n\t\t\t\t\t\t<i class='layer-component-remove layer-component-remove"+(r+1+l)+" material-icons'>delete</i>\n\t\t\t\t\t</div>\n\t\t\t\t\t");var u=[0,a.Scene._[a.Scene.now].Images.length,a.Scene._[a.Scene.now].Texts.length,a.Scene._[a.Scene.now].Sounds.length],d=(r=u[0],l=u[1],u[2]);for(c=u[3];r<c;r++)n.append("\n\t\t\t\t\t<div class='layer-component layer-component"+(r+1+l+d)+"'>\n\t\t\t\t\t\t<i class='layer-component-icon material-icons'>music_note</i>\n\t\t\t\t\t\t<div class='layer-component-title layer-component-title"+(r+1+l+d)+"'>"+a.Scene._[a.Scene.now].Sounds[r].title+"</div>\n\t\t\t\t\t\t<i class='layer-component-remove layer-component-remove"+(r+1+l+d)+" material-icons'>delete</i>\n\t\t\t\t\t</div>\n\t\t\t\t\t");e.dom.rewrite(n.el),e.eventListener(t)},e.clear=function(){e.dom.rewrite("")},e.eventListener=function(t){for(var n=function(n,o){document.querySelector(".layer-component-remove"+(n+1)).addEventListener("click",function(o){t.release(),a.Scene._[a.Scene.now].Images[n].element.remove(),a.Scene._[a.Scene.now].Images.splice(n,1),e.render(t)},!1)},o=[0,a.Scene._[a.Scene.now].Images.length],i=o[0],r=o[1];i<r;i++)n(i);var s=function(n,o,i){document.querySelector(".layer-component-remove"+(n+1+o)).addEventListener("click",function(o){t.release(),a.Scene._[a.Scene.now].Texts[n].element.remove(),a.Scene._[a.Scene.now].Texts.splice(n,1),e.render(t)},!1)},l=[0,a.Scene._[a.Scene.now].Images.length,a.Scene._[a.Scene.now].Texts.length],u=(i=l[0],l[1]);for(r=l[2];i<r;i++)s(i,u);var d=function(n,o,i,r){document.querySelector(".layer-component-remove"+(n+1+o+i)).addEventListener("click",function(o){t.release(),a.Scene._[a.Scene.now].Sounds[n].element.remove(),a.Scene._[a.Scene.now].Sounds.splice(n,1),e.render(t)},!1)},f=[0,a.Scene._[a.Scene.now].Images.length,a.Scene._[a.Scene.now].Texts.length,a.Scene._[a.Scene.now].Sounds.length],m=(i=f[0],u=f[1],f[2]);for(r=f[3];i<r;i++)d(i,u,m);var v=[a.Scene._[a.Scene.now].Camera].concat(a.Scene._[a.Scene.now].Images,a.Scene._[a.Scene.now].Texts,a.Scene._[a.Scene.now].Sounds),h=function(e,n){document.querySelector(".layer-component-title"+e).addEventListener("click",function(n){t.activate(v[e].className,v[e].types)},!1),3!==v[e].types&&(document.querySelector(".layer-component"+e).addEventListener("mouseenter",function(t){p.setOptionStyle(v[e].element)},!1),document.querySelector(".layer-component"+e).addEventListener("mouseleave",function(t){void 0!==c.Active&&c.Active.className===v[e].className?p.setActiveStyle(v[e].element):p.removeOutlineStyle(v[e].element)},!1))},y=[0,v.length];for(i=y[0],r=y[1];i<r;i++)h(i)},e.dom=new i.DOM(".layer"),e.button=new i.DOM(".showlayer"),e.opened=!1,e}();e.Layer=d;var f=function(){function e(){}return e.show=function(){void 0!==c.Active&&(e.dom.el.style.left="-15vw",e.button.el.style.color="rgb(0,200,180)",d.hide(),e.opened=!0)},e.hide=function(){e.dom.el.style.left="0",e.button.el.style.color="",e.opened=!1},e.render=function(){var t=a.Scene._[a.Scene.now].Images.concat(a.Scene._[a.Scene.now].Texts),n=new i.DOM;n.append('<div class="trigger-index">Animation Trigger</div>'),n.append('\n\t\t\t\t<div class=\'trigger-component\'>\n\t\t\t\t\t<input type="checkbox" id="trigger-component0"\n\t\t\t\t\t'+([].indexOf.call(c.Active.trigger,"scenechange")>-1?"checked":"")+">\n\t\t\t\t\t<label class='trigger-component0 trigger-component-label' for=\"trigger-component0\">Scene Change to No."+a.Scene.now+"</label>\n\t\t\t\t</div>\n\t\t\t\t"),n.append('\n\t\t\t\t<div class=\'trigger-component\'>\n\t\t\t\t\t<input type="checkbox" id="trigger-component1"\n\t\t\t\t\t'+([].indexOf.call(c.Active.trigger,"canvas")>-1?"checked":"")+">\n\t\t\t\t\t<label class='trigger-component1 trigger-component-label' for=\"trigger-component1\">Canvas Touch</label>\n\t\t\t\t</div>\n\t\t\t");for(var o=[0,t.length],r=o[0],s=o[1];r<s;r++)n.append('\n\t\t\t\t\t<div class=\'trigger-component\'>\n\t\t\t\t\t\t<input type="checkbox" id="trigger-component'+(r+2)+'"\n\t\t\t\t\t\t'+([].indexOf.call(c.Active.trigger,t[r].className)>-1?"checked":"")+">\n\t\t\t\t\t\t<label class='trigger-component"+(r+2)+" trigger-component-label' for=\"trigger-component"+(r+2)+'">'+t[r].title+"</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t");e.dom.rewrite(n.el),e.eventListener(t)},e.clear=function(){e.dom.rewrite("")},e.eventListener=function(e){document.querySelector(".trigger-component0").addEventListener("click",function(e){[].indexOf.call(c.Active.trigger,"scenechange")<0?c.Active.trigger.push("scenechange"):c.Active.trigger=c.Active.trigger.filter(function(e){return"scenechange"!==e})},!1),document.querySelector(".trigger-component1").addEventListener("click",function(e){[].indexOf.call(c.Active.trigger,"canvas")<0?c.Active.trigger.push("canvas"):c.Active.trigger=c.Active.trigger.filter(function(e){return"canvas"!==e})},!1);for(var t=function(t,n){document.querySelector(".trigger-component"+(t+2)).addEventListener("click",function(n){[].indexOf.call(c.Active.trigger,e[t].className)<0?c.Active.trigger.push(e[t].className):c.Active.trigger=c.Active.trigger.filter(function(n){return n!==e[t].className})},!1),document.querySelector(".trigger-component"+(t+2)).addEventListener("mouseenter",function(n){p.setOptionStyle(e[t].element)},!1),document.querySelector(".trigger-component"+(t+2)).addEventListener("mouseleave",function(n){void 0!==c.Active&&c.Active.className===e[t].className?p.setActiveStyle(e[t].element):p.removeOutlineStyle(e[t].element)},!1)},n=[0,e.length],o=n[0],i=n[1];o<i;o++)t(o)},e.dom=new i.DOM(".trigger"),e.button=new i.DOM(".keyframe-showtrigger"),e.opened=!1,e}();e.Trigger=f;var m=function(){function e(){}var n,o,r,a,s;return e.render=function(){t.PalletActive.title.dom.el.textContent=c.Active.title,e.delay.dom.el.textContent=c.Active.delay,e.iteration.dom.el.textContent=c.Active.iteration,document.active.float.checked=c.Active.float,document.active.touch.checked=c.Active.touchable;for(var n=new i.DOM,o=[0,c.Active.state.length],r=o[0],a=o[1];r<a;r++)n.append("\n                    <div class='keyframe-state "+(r===a-1?"keyframe-state-current":"")+" keyframe-state"+r+"'>\n\t\t\t\t\t\t<div class='keyframe-state-number"+r+" keyframe-state-number'>State: "+r+"</div>\n\t\t\t\t\t\t<div class='keyframe-state-src"+r+" keyframe-state-src' "+(2===c.Active.types?"contenteditable='true'":"")+">"+c.Active.state[r].src+"</div>\n\t\t\t\t\t\t<div class='keyframe-state-duration"+r+" keyframe-state-duration'>\n\t\t\t\t\t\t\t<div class='keyframe-state-duration-index'>Duration:</div>\n\t\t\t\t\t\t\t<div class='keyframe-state-duration-value"+r+" keyframe-state-duration-value' contenteditable='true'>"+c.Active.state[r].duration+"</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t"+(1===c.Active.types||3===c.Active.types?"<input type='file' class='keyframe-state-input"+r+"' style='display:none;'>":"")+"\n\t\t\t\t\t\t<div class='keyframe-state-icon'>\n\t\t\t\t\t\t\t<i class='keyframe-state-update"+r+" keyframe-state-update material-icons' state='"+r+"'>refresh</i>\n\t\t\t\t\t\t\t"+(r>0?"<i class='keyframe-state-remove"+r+" keyframe-state-remove material-icons' state='"+r+"'>delete</i>":"")+"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t"+(0!==c.Active.types?"<div class='keyframe-state-option-show"+r+" keyframe-state-option-show'><div class='plusminus"+r+" plusminus'><span></span><span></span></div></div>":"")+"\n\t\t\t\t\t</div>\n\t\t\t\t\t"+(0!==c.Active.types?"<div class='keyframe-state-option"+r+" keyframe-state-option' contenteditable='true'>/*Optional CSS*/"+p.removeActiveStyle(c.Active.state[r].option)+"</div>":"")+"\n\t\t\t\t\t");e.stateList.dom.rewrite(n.el),e.eventListener()},e.clear=function(){e.stateList.dom.rewrite("")},e.eventListener=function(){document.createElement("input").type="file";for(var t=function(t,n){document.querySelector(".keyframe-state-number"+t).addEventListener("click",function(e){c.Active.transition(c.Active.state[t]);var n=document.querySelector(".keyframe-state-current");n&&n.classList.remove("keyframe-state-current"),document.querySelector(".keyframe-state"+t).classList.add("keyframe-state-current")},!1),document.querySelector(".keyframe-state-duration-value"+t).addEventListener("blur",function(e){e.preventDefault(),c.Active.state[t].duration=Number(e.srcElement.textContent)},!1),document.querySelector(".keyframe-state-update"+t).addEventListener("click",function(n){n.preventDefault(),c.Active.state[t]=c.Active.now,e.render()},!1),t>0&&document.querySelector(".keyframe-state-remove"+t).addEventListener("click",function(n){n.preventDefault(),c.Active.state.splice(t,1),e.render()},!1),1!==c.Active.types&&3!==c.Active.types||(document.querySelector(".keyframe-state-input"+t).addEventListener("change",function(e){e.preventDefault();var n=e.target.files[0];document.querySelector(".keyframe-state-src"+t).textContent=n.name,c.Active.state[t].src=n.name,c.Active.transition(c.Active.state[t])},!1),document.querySelector(".keyframe-state-src"+t).addEventListener("click",function(e){e.preventDefault(),document.querySelector(".keyframe-state-input"+t).click()},!1)),2===c.Active.types&&document.querySelector(".keyframe-state-src"+t).addEventListener("blur",function(e){e.preventDefault(),c.Active.state[t].src=e.srcElement.textContent,c.Active.transition(c.Active.state[t])},!1),0!==c.Active.types&&(document.querySelector(".keyframe-state-option-show"+t).addEventListener("click",function(n){n.preventDefault(),e.cssOptionOpened?(e.cssOptionOpened=!1,document.querySelector(".plusminus"+t).classList.remove("active"),document.querySelector(".keyframe-state-option"+t).style.height="0"):(e.cssOptionOpened=!0,document.querySelector(".plusminus"+t).classList.add("active"),document.querySelector(".keyframe-state-option"+t).style.height="10rem")},!1),document.querySelector(".keyframe-state-option"+t).addEventListener("blur",function(e){e.preventDefault(),c.Active.state[t].option=e.srcElement.textContent.replace("/*Optional CSS*/",""),c.Active.transition(c.Active.state[t])},!1))},n=[0,c.Active.state.length],o=n[0],i=n[1];o<i;o++)t(o)},e.delay=((n=function(){return function(){}}()).className="keyframe-delay-value",n.dom=new i.DOM(".keyframe-delay-value"),n),e.iteration=((o=function(){return function(){}}()).className="keyframe-iteration-value",o.dom=new i.DOM(".keyframe-iteration-value"),o),e.pushState=((r=function(){return function(){}}()).className="keyframe-push-state",r.dom=new i.DOM(".keyframe-push-state"),r),e.play=((a=function(){return function(){}}()).className="keyframe-play",a.dom=new i.DOM(".keyframe-play"),a),e.stateList=((s=function(){return function(){}}()).className="keyframe-state-list",s.dom=new i.DOM(".keyframe-state-list"),s),e.cssOptionOpened=!1,e}();e.Keyframe=m;var p=function(){function e(){}return e.setOptionStyle=function(e){e.style.outlineColor=r.css.option.outlineColor,e.style.outlineStyle=r.css.option.outlineStyle,e.style.outlineWidth=r.css.option.outlineWidth},e.removeOutlineStyle=function(e){e.style.outlineColor="",e.style.outlineStyle="",e.style.outlineWidth=""},e.setActiveStyle=function(e){e.style.outlineColor=r.css.active.outlineColor,e.style.outlineStyle=r.css.active.outlineStyle,e.style.outlineWidth=r.css.active.outlineWidth},e.removeActiveStyle=function(e){return e.replace("outline-color:"+r.css.active.outlineColor+";","").replace("outline-style:"+r.css.active.outlineStyle+";","").replace("outline-width:"+r.css.active.outlineWidth+";","").replace("resize:"+r.css.resize.resize+";","").replace("overflow:"+r.css.resize.overflow+";","").replace("cursor:"+r.css.resize.cursor+";","")},e}()}(o||(o={})),t.PalletDom=o.dom,t.PalletLiveEditToggle=o.LiveEditToggle,t.PalletSceneChanger=o.SceneChanger,t.PalletSave=o.Save,t.PalletCamera=o.Camera,t.PalletActive=o.Active,t.PalletKeyframe=o.Keyframe,t.PalletTrigger=o.Trigger,t.PalletLayer=o.Layer},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(1),r=n(3),a=n(0),c=n(2),s=n(8);!function(e){var t=function(){return function(){}}();e.Structure=t;var n=function(e){function t(t){var n=e.call(this)||this;return n.scene=t.scene,n.types=0,n.className=t.className,n.title=t.title,n.touchable=!0,n.pointer="auto",n.float=!0,n.title=t.title||n.className,n.touchable=!0,n.float=!0,n.trigger=t.trigger||[],n.iteration=t.iteration,n.delay=t.delay||0,n.state=t.state,n.now=t.state[0],n.running=!1,n.element=document.querySelector(".camera"),n}return i.__extends(t,e),t.prototype.transition=function(e){var t=this,n=e.src,o=e.x,i=e.y,r=e.z,l=e.width,u=e.aspectRatio,d=e.rotate,f=e.scale,m=e.blur,p=e.opacity,v=e.chroma,h=e.light,y=e.duration,g=e.option;this.now={src:n,x:o,y:i,z:r,width:l,aspectRatio:u,rotate:d,scale:f,blur:m,opacity:p,chroma:v,light:h,duration:y,option:g},c.Scene._[this.scene].dom.el.style.transform="rotate("+d+"deg)",c.Scene._[this.scene].Images.forEach(function(e){s.CalcCSS.image_transition_for_camera(e,c.Canvas,e.now,c.Scene._[t.scene].Camera.now,a.param)}),c.Scene._[this.scene].Texts.forEach(function(e){s.CalcCSS.text_transition_for_camera(e,c.Canvas,e.now,c.Scene._[t.scene].Camera.now,a.param)})},t}(t);e.Camera=n;var o=function(e){function t(t,n){var o=e.call(this)||this;return o.scene=t.scene,o.types=1,o.className=t.className||"img"+d(),o.title=t.title||o.className,o.touchable=t.touchable,o.pointer=o.touchable?"auto":"none",o.float=t.float,o.trigger=t.trigger||[],o.iteration=t.iteration,o.delay=t.delay||0,o.running=!1,o.state=t.state,o.now=t.state[0],o.createElement(o.className,t.state[0],n),o}return i.__extends(t,e),t.prototype.createElement=function(e,t,n){this.element=new r.DOM("\n\t\t\t<div "+(a.config.live?"":'draggable="true"\n\t\t\t\t ondragstart="componentDragStart(event);"\n\t\t\t\t ondragend="componentDragEnd(event);"\n\t\t\t     onclick="componentClick(event);"\n\t\t\t     onmouseup="componentMouseUp(event);"')+'\n\t\t\t class="'+e+' image"\n\t\t\t style="'+(this.float?s.CalcCSS.image_float(c.Canvas,t,n,a.config,a.param,this.pointer):s.CalcCSS.image_fix(c.Canvas,t,n,a.config,this.pointer))+'\n\t\t\t "></div>\n\t\t\t').el},t.prototype.transition=function(e){var t=e.src,n=e.x,o=e.y,i=e.z,r=e.width,l=e.aspectRatio,u=e.rotate,d=e.scale,f=e.blur,m=e.opacity,p=e.chroma,v=e.light,h=e.duration,y=e.option;this.now={src:t,x:n,y:o,z:i,width:r,aspectRatio:l,rotate:u,scale:d,blur:f,opacity:m,chroma:p,light:v,duration:h,option:y},s.CalcCSS.image_transition(this,c.Canvas,this.now,c.Scene._[this.scene].Camera.now,a.config,a.param)},t}(t);e.Image=o;var l=function(e){function t(t,n){var o=e.call(this)||this;return o.scene=t.scene,o.types=2,o.className=t.className||"txt"+d(),o.title=t.title||o.className,o.touchable=t.touchable,o.pointer=o.touchable?"auto":"none",o.float=t.float,o.trigger=t.trigger||[],o.iteration=t.iteration,o.delay=t.delay||0,o.state=t.state,o.now=t.state[0],o.running=!1,o.createElement(o.className,t.state[0],n),o}return i.__extends(t,e),t.prototype.createElement=function(e,t,n){this.element=new r.DOM("\n\t\t\t<div "+(a.config.live?"":'draggable="true" contenteditable="false"\n\t\t\t\tondragstart="componentDragStart(event);"\n\t\t\t\tondragend="componentDragEnd(event);"\n\t\t\t\tonclick="componentClick(event);"\n\t\t\t\tonblur="componentBlur(event);"\n\t\t\t\tonmouseup="componentMouseUp(event);"\n\t\t\t\tonresize="componentResize(event);"')+'\n\t\t\t class="'+e+' text"\n\t\t\t style="'+(this.float?s.CalcCSS.text_float(c.Canvas,t,n,a.param,this.pointer):s.CalcCSS.text_fix(c.Canvas,t,n,this.pointer))+'\n\t\t\t ">'+t.src+"</div>\n\t\t\t").el},t.prototype.transition=function(e){var t=e.src,n=e.x,o=e.y,i=e.z,r=e.width,l=e.aspectRatio,u=e.rotate,d=e.scale,f=e.blur,m=e.opacity,p=e.chroma,v=e.light,h=e.duration,y=e.option;this.now={src:t,x:n,y:o,z:i,width:r,aspectRatio:l,rotate:u,scale:d,blur:f,opacity:m,chroma:p,light:v,duration:h,option:y},s.CalcCSS.text_transition(this,c.Canvas,this.now,c.Scene._[this.scene].Camera.now,a.param)},t}(t);e.Text=l;var u=function(e){function t(t){var n=e.call(this)||this;return n.scene=t.scene,n.types=3,n.className=t.className||"sound"+d(),n.title=t.title||n.className,n.touchable=t.touchable,n.pointer="auto",n.float=t.float,n.trigger=t.trigger||[],n.iteration=t.iteration,n.delay=t.delay||0,n.state=t.state,n.now=t.state[0],n.running=!1,n.createElement(n.className),n}return i.__extends(t,e),t.prototype.createElement=function(e){this.element=new Audio(a.config.soundSrcPath+this.state[0].src),this.element.className=e},t.prototype.transition=function(e){var t=e.src,n=e.x,o=e.y,i=e.z,r=e.width,c=e.aspectRatio,s=e.rotate,l=e.scale,u=e.blur,d=e.opacity,f=e.chroma,m=e.light,p=e.duration,v=e.option;if(this.now={src:t,x:n,y:o,z:i,width:r,aspectRatio:c,rotate:s,scale:l,blur:u,opacity:d,chroma:f,light:m,duration:p,option:v},a.config.volumeOn){var h=this.element;h.src=a.config.soundSrcPath+t,h.play().catch(function(e){console.log(e)})}},t}(t);e.Sound=u;var d=function(){return(new Date).getTime().toString(16)+~~(1e3*Math.random()).toString(16)}}(o=t.Component||(t.Component={})),t.ComponentCamera=o.Camera,t.ComponentImage=o.Image,t.ComponentText=o.Text,t.ComponentSound=o.Sound},function(e,t,n){"use strict";n.r(t),n.d(t,"CalcCSS",function(){return C});const o={};let i;const r=new Array(32);r.fill(void 0),r.push(void 0,null,!0,!1);let a=32;function c(e){if(1==a)throw new Error("out of js stack");return r[--a]=e,a}let s,l=0,u=new TextEncoder("utf-8"),d=null;function f(){return null!==d&&d.buffer===i.memory.buffer||(d=new Uint8Array(i.memory.buffer)),d}s="function"==typeof u.encodeInto?function(e){let t=e.length,n=i.__wbindgen_malloc(t),o=0;{const t=f();for(;o<e.length;o++){const i=e.charCodeAt(o);if(i>127)break;t[n+o]=i}}if(o!==e.length){e=e.slice(o),n=i.__wbindgen_realloc(n,t,t=o+3*e.length);const r=f().subarray(n+o,n+t);o+=u.encodeInto(e,r).written}return l=o,n}:function(e){let t=e.length,n=i.__wbindgen_malloc(t),o=0;{const t=f();for(;o<e.length;o++){const i=e.charCodeAt(o);if(i>127)break;t[n+o]=i}}if(o!==e.length){const r=u.encode(e.slice(o));n=i.__wbindgen_realloc(n,t,t=o+r.length),f().set(r,n+o),o+=r.length}return l=o,n};let m=new TextDecoder("utf-8");function p(e,t){return m.decode(f().subarray(e,e+t))}let v=null;function h(){return null===v&&(v=i.__wbindgen_global_argument_ptr()),v}let y=null;function g(){return null!==y&&y.buffer===i.memory.buffer||(y=new Uint32Array(i.memory.buffer)),y}function w(e){return r[e]}o.__wbg_float_6d3d92616b55ef6d=function(e){return w(e).float};let S=r.length;function _(e){S===r.length&&r.push(r.length+1);const t=S;return S=r[t],r[t]=e,t}function b(e,t){const n=g();n[e/4]=1,n[e/4+1]=_(t)}o.__wbg_element_3f8bfacc2eb62b78=function(e){return _(w(e).element)},o.__wbg_setnow_b984c1ff57bc4064=function(e,t){w(e).now=w(t)},o.__widl_f_set_property_CSSStyleDeclaration=function(e,t,n,o,i,r){let a=p(t,n),c=p(o,i);try{w(e).setProperty(a,c)}catch(e){b(r,e)}},o.__widl_f_set_css_text_CSSStyleDeclaration=function(e,t,n){let o=p(t,n);w(e).cssText=o},o.__widl_f_style_HTMLElement=function(e){return _(w(e).style)},o.__wbg_get_48d637c66043532c=function(e,t,n){try{return _(Reflect.get(w(e),w(t)))}catch(e){b(n,e)}},o.__wbindgen_string_new=function(e,t){return _(p(e,t))},o.__wbindgen_number_get=function(e,t){let n=w(e);return"number"==typeof n?n:(f()[t]=1,0)},o.__wbindgen_boolean_get=function(e){let t=w(e);return"boolean"==typeof t?t?1:0:2},o.__wbindgen_string_get=function(e,t){let n=w(e);if("string"!=typeof n)return 0;const o=s(n);return g()[t/4]=l,o},o.__wbindgen_debug_string=function(e,t){const n=e=>{const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let o="[";t>0&&(o+=n(e[0]));for(let i=1;i<t;i++)o+=", "+n(e[i]);return o+="]"}const i=/\[object ([^\]]+)\]/.exec(o.call(e));let r;if(!(i.length>1))return o.call(e);if("Object"==(r=i[1]))try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n        ${e.stack}`:r},o=Object.prototype.toString,i=w(e),r=n(i),a=s(r);return g()[t/4]=l,a},o.__wbindgen_throw=function(e,t){throw new Error(p(e,t))};class C{free(){const e=this.ptr;this.ptr=0,function(e){i.__wbg_calccss_free(e)}(e)}static image_transition(e,t,n,o,s,l){try{return i.calccss_image_transition(c(e),c(t),c(n),c(o),c(s),c(l))}finally{r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0}}static text_transition(e,t,n,o,s){try{return i.calccss_text_transition(c(e),c(t),c(n),c(o),c(s))}finally{r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0}}static image_transition_for_camera(e,t,n,o,s){try{return i.calccss_image_transition_for_camera(c(e),c(t),c(n),c(o),c(s))}finally{r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0}}static text_transition_for_camera(e,t,n,o,s){try{return i.calccss_text_transition_for_camera(c(e),c(t),c(n),c(o),c(s))}finally{r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0}}static image_float(e,t,n,o,u,d){const f=s(d),m=l,v=h();try{i.calccss_image_float(v,c(e),c(t),c(n),c(o),c(u),f,m);const s=g(),l=s[v/4],d=s[v/4+1],h=p(l,d).slice();return i.__wbindgen_free(l,1*d),h}finally{r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,i.__wbindgen_free(f,1*m)}}static image_fix(e,t,n,o,u){const d=s(u),f=l,m=h();try{i.calccss_image_fix(m,c(e),c(t),c(n),c(o),d,f);const s=g(),l=s[m/4],u=s[m/4+1],v=p(l,u).slice();return i.__wbindgen_free(l,1*u),v}finally{r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,i.__wbindgen_free(d,1*f)}}static text_float(e,t,n,o,u){const d=s(u),f=l,m=h();try{i.calccss_text_float(m,c(e),c(t),c(n),c(o),d,f);const s=g(),l=s[m/4],u=s[m/4+1],v=p(l,u).slice();return i.__wbindgen_free(l,1*u),v}finally{r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,i.__wbindgen_free(d,1*f)}}static text_fix(e,t,n,o){const u=s(o),d=l,f=h();try{i.calccss_text_fix(f,c(e),c(t),c(n),u,d);const o=g(),s=o[f/4],l=o[f/4+1],m=p(s,l).slice();return i.__wbindgen_free(s,1*l),m}finally{r[a++]=void 0,r[a++]=void 0,r[a++]=void 0,i.__wbindgen_free(u,1*d)}}}o.__wbindgen_object_drop_ref=function(e){var t;(t=e)<36||(r[t]=S,S=t)},t.default=function e(t){let n;const r={"./wasm":o};if(t instanceof URL||"string"==typeof t||t instanceof Request){const e=fetch(t);n="function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(e,r).catch(t=>(console.warn("`WebAssembly.instantiateStreaming` failed. Assuming this is because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t),e.then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,r)))):e.then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,r))}else n=WebAssembly.instantiate(t,r).then(e=>e instanceof WebAssembly.Instance?{instance:e,module:t}:e);return n.then(({instance:t,module:n})=>(i=t.exports,e.__wbindgen_wasm_module=n,i))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(0),r=n(2);!function(e){var t=function(){function e(){}return e.add=function(e,t){return{src:e.src,x:e.x+t.x,y:e.y+t.y,z:e.z+t.z,width:e.width+t.width,aspectRatio:e.aspectRatio+t.aspectRatio,rotate:e.rotate+t.rotate,scale:e.scale+t.scale,blur:e.blur+t.blur,opacity:e.opacity+t.opacity,chroma:e.chroma+t.chroma,light:e.light+t.light,duration:e.duration,option:e.option}},e.diff=function(e,t){var n=t.duration>0?1/t.duration*i.param.animation.skipFrame:0;return{src:e.src,x:(t.x-e.x)*n,y:(t.y-e.y)*n,z:(t.z-e.z)*n,width:(t.width-e.width)*n,aspectRatio:(t.aspectRatio-e.aspectRatio)*n,rotate:(t.rotate-e.rotate)*n,scale:(t.scale-e.scale)*n,blur:(t.blur-e.blur)*n,opacity:(t.opacity-e.opacity)*n,chroma:(t.chroma-e.chroma)*n,light:(t.light-e.light)*n,duration:e.duration,option:e.option}},e}(),n=function(){return function(e){r.Scene._[e.scene].dom.el.addEventListener("touchend",function(t){i.config.live&&(t.preventDefault(),[].indexOf.call(e.trigger,t.srcElement.classList.item(0))>-1&&new o(e))},!1),i.config.live||r.Scene._[e.scene].dom.el.addEventListener("contextmenu",function(t){i.config.live||(t.preventDefault(),[].indexOf.call(e.trigger,t.srcElement.classList.item(0))>-1&&new o(e))},!1)}}();e.Register=n;var o=function(){function e(e){this.iteration=0,this.target=e,this.param=i.param,this.init()}return e.prototype.init=function(){this.target.running||(this.state_length=this.target.state.length,this.state_length<2||(this.target.running=!0,this.target.transition(this.target.state[0]),this.calcDiff(),this.delayStart(0)))},e.prototype.calcDiff=function(){this.diff=[];for(var e=[0,this.state_length-1],n=e[0],o=e[1];n<o;n++)this.diff.push(t.diff(this.target.state[n],this.target.state[n+1]))},e.prototype.delayStart=function(e){var t=this;this.target.running&&(e<this.target.delay?window.requestAnimationFrame(function(){return t.delayStart(e+1)}):this.iterate())},e.prototype.iterate=function(){0===this.target.iteration?(this.target.transition(this.target.state[0]),this.shift(1)):0===this.iteration?(this.iteration+=1,this.shift(1)):this.iteration>0&&this.iteration<this.target.iteration?(this.target.transition(this.target.state[0]),this.iteration+=1,this.shift(1)):(this.iteration=0,this.target.running=!1)},e.prototype.shift=function(e){e<this.state_length?this.move(0,e):this.wait(0)},e.prototype.wait=function(e){var t=this;this.target.running&&(e<this.target.state[0].duration?window.requestAnimationFrame(function(){return t.wait(e+1)}):this.iterate())},e.prototype.move=function(e,n){var o=this;this.target.running&&(e%this.param.animation.skipFrame==0?e<this.target.state[n].duration?(this.target.transition(t.add(this.target.now,this.diff[n-1])),window.requestAnimationFrame(function(){return o.move(e+1,n)})):(this.target.transition(this.target.state[n]),this.shift(n+1)):window.requestAnimationFrame(function(){return o.move(e+1,n)}))},e}();e.Play=o}(o=t.Animation||(t.Animation={})),t.AnimationRegister=o.Register,t.AnimationPlay=o.Play},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(0),r=n(2);!function(e){var t=function(){return function(e){r.Scene._[e.scene].dom.el.addEventListener("touchend",function(t){i.config.live&&(t.preventDefault(),[].indexOf.call(e.trigger,t.srcElement.classList.item(0))>-1&&new n(e))},!1),i.config.live||r.Scene._[e.scene].dom.el.addEventListener("contextmenu",function(t){i.config.live||(t.preventDefault(),[].indexOf.call(e.trigger,t.srcElement.classList.item(0))>-1&&new n(e))},!1)}}();e.Register=t;var n=function(){function e(e){this.iteration=0,this.stateLength=e.state.length,this.stateLength<1||this.delayStart(e,0)}return e.prototype.delayStart=function(e,t){var n=this;t<e.delay?window.requestAnimationFrame(function(){return n.delayStart(e,t+1)}):(this.iterate(e),e.element.onended=function(){n.wait(e,0)})},e.prototype.iterate=function(e){0===e.iteration?(e.transition(e.state[0]),this.shift(e,1)):this.iteration<e.iteration?(this.iteration+=1,e.transition(e.state[0]),this.shift(e,1)):this.iteration=0},e.prototype.shift=function(e,t){t<this.stateLength&&this.move(e,0,t)},e.prototype.wait=function(e,t){var n=this;t<e.state[0].duration?window.requestAnimationFrame(function(){return n.wait(e,t+1)}):this.iterate(e)},e.prototype.move=function(e,t,n){var o=this;t<e.state[n].duration?window.requestAnimationFrame(function(){return o.move(e,t+1,n)}):(e.transition(e.state[n]),this.shift(e,n+1))},e}();e.Play=n}(o=t.SoundPlayer||(t.SoundPlayer={})),t.SoundPlayerRegister=o.Register,t.SoundPlayerPlay=o.Play},function(e,t,n){"use strict";var o=this;Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(12),a=n(13),c=n(0),s=n(8);i.__awaiter(o,void 0,void 0,function(){var e=this;return i.__generator(this,function(t){switch(t.label){case 0:return[4,s.default("./src/wasm/pkg/wasm_bg.wasm")];case 1:return t.sent(),[4,c.readSetting().then(function(){return i.__awaiter(e,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,(new a.Render).start().catch(function(e){return console.log(e)})];case 1:return e.sent(),[2]}})})}).then(function(){return i.__awaiter(e,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,(new r.EventListen).start().catch(function(e){return console.log(e)})];case 1:return e.sent(),[2]}})})}).catch(function(e){console.log(e)})];case 2:return t.sent(),[2]}})}).catch(function(e){return console.log(e)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(1),r=n(0),a=n(2),c=n(6),s=n(4),l=n(9),u=n(10);t.keyDown=null,function(e){var n={x:0,y:0},o={13:"enter",17:"ctrl",88:"x",89:"y",90:"z",83:"s",82:"r",66:"b",79:"o",76:"l",67:"c"},d=function(){function e(){}return e.prototype.start=function(){return i.__awaiter(this,void 0,void 0,function(){var e=this;return i.__generator(this,function(t){return[2,new Promise(function(t){e.commonSetting(),e.editModeSetting(),a.Scene.init(),t()})]})})},e.prototype.commonSetting=function(){this.CanvasTouch(),this.SceneChange(),this.SceneChanger(),this.AnimationRegister(),this.CanvasSwipe(),this.HoverHeader(),this.VolumeToggle()},e.prototype.editModeSetting=function(){this.liveEditToggle(),this.DetectKeyDown(),this.CanvasWheel(),this.CanvasDoubleClick(),this.CameraClick(),this.SaveClick(),this.CanvasDrop(),this.TitleChange(),this.SwitchFloat(),this.SwitchTouch(),this.DelayChange(),this.IterationChange(),this.PushStateClick(),this.PlayClick(),this.ShowLayerClick(),this.ShowTriggerClick(),this.ImageEvent()},e.prototype.liveEditToggle=function(){c.PalletLiveEditToggle.dom.on("change",function(e){e.preventDefault(),r.config.live=document["live-edit"].toggle.checked,r.config.live?(s.EditorSelector.release(),c.PalletDom.style.display="none",a.Canvas.element.classList.remove("canvas-edit"),a.Canvas.element.classList.add("canvas-live"),a.Canvas.paper.classList.remove("paper-edit"),a.Canvas.paper.classList.add("paper-live"),a.Frame.header.classList.remove("header-edit"),a.Frame.header.classList.add("header-live"),a.Frame.footer.classList.remove("footer-edit"),a.Frame.footer.classList.add("footer-live"),a.Frame.headerTitle.contentEditable="false",a.Frame.show()):(c.PalletDom.style.display="",a.Canvas.element.classList.remove("canvas-live"),a.Canvas.element.classList.add("canvas-edit"),a.Canvas.paper.classList.remove("paper-live"),a.Canvas.paper.classList.add("paper-edit"),a.Frame.header.classList.remove("header-live"),a.Frame.header.classList.add("header-edit"),a.Frame.footer.classList.remove("footer-live"),a.Frame.footer.classList.add("footer-edit"),a.Frame.headerTitle.contentEditable="true")})},e.prototype.DetectKeyDown=function(){document.addEventListener("keydown",function(e){null===t.keyDown&&(t.keyDown=o[e.keyCode])},!1),document.addEventListener("keyup",function(){t.keyDown=null},!1)},e.prototype.CanvasWheel=function(){a.Canvas.dom.on("mousewheel",function(e){if(!r.config.live&&void 0!==s.Active)switch(e.preventDefault(),t.keyDown){case"x":s.EditorTransform.translate(s.Active,e.deltaY*r.param.wheelResponse.XY,0,0);break;case"y":s.EditorTransform.translate(s.Active,0,e.deltaY*r.param.wheelResponse.XY,0);break;case"z":s.Active.float&&s.EditorTransform.translate(s.Active,0,0,e.deltaY*r.param.wheelResponse.Z);break;case"r":s.EditorTransform.rotate(s.Active,e.deltaY*r.param.wheelResponse.rotate);break;case"s":s.EditorTransform.scale(s.Active,e.deltaY*r.param.wheelResponse.scale);break;case"b":s.EditorTransform.blur(s.Active,e.deltaY*r.param.wheelResponse.blur);break;case"o":s.EditorTransform.opacity(s.Active,e.deltaY*r.param.wheelResponse.opacity);break;case"l":s.EditorTransform.light(s.Active,e.deltaY*r.param.wheelResponse.light);break;case"c":s.EditorTransform.chroma(s.Active,e.deltaY*r.param.wheelResponse.chroma)}})},e.prototype.CanvasTouch=function(){a.Canvas.dom.touch(function(e){r.config.live&&(e.preventDefault(),[a.Scene._[a.Scene.now].Camera].concat(a.Scene._[a.Scene.now].Images,a.Scene._[a.Scene.now].Texts).forEach(function(e){e.scene===a.Scene.now&&[].indexOf.call(e.trigger,"canvas")>-1&&new l.Animation.Play(e)}),a.Scene._[a.Scene.now].Sounds.forEach(function(e){e.scene===a.Scene.now&&[].indexOf.call(e.trigger,"canvas")>-1&&new u.SoundPlayer.Play(e)}))}),r.config.live||a.Canvas.dom.on("contextmenu",function(e){r.config.live||(e.preventDefault(),[a.Scene._[a.Scene.now].Camera].concat(a.Scene._[a.Scene.now].Images,a.Scene._[a.Scene.now].Texts).forEach(function(e){e.scene===a.Scene.now&&[].indexOf.call(e.trigger,"canvas")>-1&&new l.Animation.Play(e)}),a.Scene._[a.Scene.now].Sounds.forEach(function(e){e.scene===a.Scene.now&&[].indexOf.call(e.trigger,"canvas")>-1&&new u.SoundPlayer.Play(e)}))})},e.prototype.AnimationRegister=function(){for(var e=[0,a.Scene._.length],t=e[0],n=e[1];t<n;t++)[a.Scene._[t].Camera].concat(a.Scene._[t].Images,a.Scene._[t].Texts).forEach(function(e){e.state.length>0&&new l.Animation.Register(e)}),a.Scene._[t].Sounds.forEach(function(e){new u.SoundPlayer.Register(e)})},e.prototype.VolumeToggle=function(){a.Frame.volume.addEventListener("click",function(){r.config.volumeOn?a.Frame.volumeOff():a.Frame.volumeOn()},!1)},e.prototype.HoverHeader=function(){a.Frame.header.addEventListener("mouseenter",function(){a.Frame.show()},!1),a.Frame.header.addEventListener("mouseleave",function(){a.Frame.hide()},!1)},e.prototype.SceneChange=function(){document.addEventListener("sceneChange",function(){for(var e=function(e,t){[a.Scene._[e].Camera].concat(a.Scene._[e].Images,a.Scene._[e].Texts).forEach(function(t){t.scene===a.Scene.now&&[].indexOf.call(t.trigger,"scenechange")>-1?new l.Animation.Play(t):e!==a.Scene.now&&(t.running=!1)})},t=[0,a.Scene._.length],n=t[0],o=t[1];n<o;n++)e(n);a.Scene._[a.Scene.now].Sounds.forEach(function(e){if([].indexOf.call(e.trigger,"scenechange")>-1){for(var t=[0,a.Scene._.length],n=t[0],o=t[1];n<o;n++)n!==a.Scene.now&&a.Scene._[n].Sounds.forEach(function(e){e.element.pause()});new u.SoundPlayer.Play(e)}})})},e.prototype.SceneChanger=function(){c.PalletSceneChanger.forward.on("click",function(e){e.preventDefault(),a.Scene.change(a.Scene.now+1),c.PalletSceneChanger.current.el.textContent="Scene:"+a.Scene.now,s.EditorSelector.release(),c.PalletLayer.hide()}),c.PalletSceneChanger.back.on("click",function(e){e.preventDefault(),a.Scene.change(a.Scene.now-1),c.PalletSceneChanger.current.el.textContent="Scene:"+a.Scene.now,s.EditorSelector.release(),c.PalletLayer.hide()}),c.PalletSceneChanger.remove.on("click",function(e){e.preventDefault(),a.Scene.remove(a.Scene.now),c.PalletSceneChanger.current.el.textContent="Scene:"+a.Scene.now,s.EditorSelector.release(),c.PalletLayer.hide()}),c.PalletSceneChanger.add.on("click",function(e){e.preventDefault(),s.EditorEventHandler.addNewScene(),c.PalletSceneChanger.current.el.textContent="Scene:"+a.Scene.now,s.EditorSelector.release(),c.PalletLayer.hide()})},e.prototype.CanvasSwipe=function(){a.Canvas.dom.swipe("left",function(e){e.preventDefault(),a.Scene.change(a.Scene.now+1),c.PalletSceneChanger.current.el.textContent="Scene:"+a.Scene.now,s.EditorSelector.release(),c.PalletLayer.hide()}),a.Canvas.dom.swipe("right",function(e){e.preventDefault(),a.Scene.change(a.Scene.now-1),c.PalletSceneChanger.current.el.textContent="Scene:"+a.Scene.now,s.EditorSelector.release(),c.PalletLayer.hide()})},e.prototype.CanvasDoubleClick=function(){a.Canvas.dom.on("dblclick",function(e){e.preventDefault(),s.EditorSelector.release()})},e.prototype.CanvasDrop=function(){a.Canvas.dom.on("drop",function(e){if(!r.config.live&&(e.preventDefault(),void 0!==e.dataTransfer))for(var t=0;t<e.dataTransfer.items.length;t++)"file"===e.dataTransfer.items[t].kind&&s.EditorEventHandler.CanvasDrop(e.clientX,e.clientY,e.dataTransfer.items[t].getAsFile())})},e.prototype.CameraClick=function(){c.PalletCamera.dom.on("click",function(e){e.preventDefault(),s.EditorEventHandler.CameraClick(c.PalletCamera.className)})},e.prototype.SaveClick=function(){c.PalletSave.dom.append('<a id="save" href="" download="story.json" style="display:none;"></a>');var e=document.querySelector("#save");c.PalletSave.dom.on("click",function(){void 0!==s.Active&&s.EditorCSS.removeActiveStyle(s.Active);var t=JSON.stringify({title:a.Frame.headerTitle.textContent,scenes:a.Scene._}),n=new Blob([t],{type:"application/json"});e.href=window.URL.createObjectURL(n),e.click()})},e.prototype.TitleChange=function(){c.PalletActive.title.dom.on("blur",function(e){void 0!==s.Active&&(e.preventDefault(),s.Active.title=c.PalletActive.title.dom.el.textContent)})},e.prototype.SwitchTouch=function(){c.PalletActive.touch.dom.on("change",function(e){void 0!==s.Active&&(e.preventDefault(),s.Active.touchable=document.active.touch.checked,s.Active.pointer=s.Active.touchable?"auto":"none",s.Active.element.style.pointerEvents=s.Active.touchable?"auto":"none")})},e.prototype.SwitchFloat=function(){c.PalletActive.float.dom.on("change",function(e){void 0!==s.Active&&(e.preventDefault(),s.Active.float=document.active.float.checked,s.Active.now.x=50-.5*s.Active.now.width,s.Active.now.y=50-.5*s.Active.now.width*s.Active.now.aspectRatio,s.Active.transition(s.Active.now))})},e.prototype.DelayChange=function(){c.PalletKeyframe.delay.dom.on("blur",function(e){void 0!==s.Active&&(e.preventDefault(),s.Active.delay=Number(c.PalletKeyframe.delay.dom.el.textContent))})},e.prototype.IterationChange=function(){c.PalletKeyframe.iteration.dom.on("blur",function(e){void 0!==s.Active&&(e.preventDefault(),s.Active.iteration=Number(c.PalletKeyframe.iteration.dom.el.textContent))})},e.prototype.ShowTriggerClick=function(){c.PalletTrigger.button.on("click",function(e){void 0!==s.Active&&(e.preventDefault(),s.EditorEventHandler.ShowTriggerClick())})},e.prototype.PlayClick=function(){c.PalletKeyframe.play.dom.on("click",function(e){void 0!==s.Active&&(e.preventDefault(),s.EditorEventHandler.PlayClick())})},e.prototype.PushStateClick=function(){c.PalletKeyframe.pushState.dom.on("click",function(e){void 0!==s.Active&&(e.preventDefault(),s.EditorEventHandler.PushStateClick())})},e.prototype.ShowLayerClick=function(){c.PalletLayer.button.on("click",function(e){e.preventDefault(),s.EditorEventHandler.ShowLayerClick()})},e.prototype.ImageEvent=function(){Object.defineProperty(window,"baseLayerClick",{value:function(e){r.config.live||(e.preventDefault(),s.EditorEventHandler.BaseLayerClick())}}),Object.defineProperty(window,"componentClick",{value:function(e){if(e.preventDefault(),!r.config.live){var t=e.srcElement.classList.item(0),n=e.srcElement.classList.item(1);s.EditorEventHandler.ComponentClick(t,n)}}}),Object.defineProperty(window,"componentBlur",{value:function(e){if(!r.config.live&&void 0!==s.Active){if(2!==s.Active.types)return;e.preventDefault(),s.Active.now.src=e.srcElement.textContent,s.Active.transition(s.Active.now)}}}),Object.defineProperty(window,"componentDragStart",{value:function(e){if(!r.config.live){if(void 0===s.Active||void 0===e.srcElement)return;var t=e.srcElement.classList.item(0);if(s.Active.className!==t)return;n.x=e.clientX,n.y=e.clientY}}}),Object.defineProperty(window,"componentDragEnd",{value:function(e){if(e.preventDefault(),!r.config.live&&void 0!==s.Active&&void 0!==e.srcElement){var o=e.srcElement.classList.item(0);if(s.Active.className===o){var i=s.Active.float?(a.Scene._[s.Active.scene].Camera.now.z-s.Active.now.z)/s.Active.now.z:1,c=100*(e.clientX-n.x)/a.Canvas.element.offsetWidth*i,l=100*(e.clientY-n.y)/a.Canvas.element.offsetHeight*i;"ctrl"===t.keyDown?s.EditorEventHandler.CanvasDropComponent(s.Active.now.x+c,s.Active.now.y+l,s.Active.types,null,s.Active):s.EditorTransform.translate(s.Active,c,l,0)}}}}),Object.defineProperty(window,"componentMouseUp",{value:function(e){if(e.preventDefault(),!r.config.live&&void 0!==s.Active){var t=e.srcElement.classList.item(0);if(s.Active.className===t){var n=1/Math.max(a.Scene._[s.Active.scene].Camera.now.z-s.Active.now.z,1),o=s.Active.float?(r.param.camera.initialZ-r.param.image.initialZ)*n:1;s.Active.now.width=~~(e.srcElement.clientWidth/a.Canvas.element.clientWidth*100)/o,s.Active.now.aspectRatio=e.srcElement.clientHeight/e.srcElement.clientWidth}}}}),Object.defineProperty(window,"componentResize",{value:function(e){if(e.preventDefault(),!r.config.live&&void 0!==s.Active){if(2!==s.Active.types)return;var t=1/Math.max(a.Scene._[s.Active.scene].Camera.now.z-s.Active.now.z,1),n=s.Active.float?(r.param.camera.initialZ-r.param.image.initialZ)*t:1;s.Active.now.width=~~(e.srcElement.clientWidth/a.Canvas.element.clientWidth*100)/n,s.Active.now.aspectRatio=e.srcElement.clientHeight/e.srcElement.clientWidth}}})},e}();e.Main=d}(o||(o={})),t.EventListen=o.Main},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(1),r=n(5),a=n(0),c=n(2),s=n(7),l=n(4);!function(e){var t=function(){function e(){this.scene=[],this.start().catch(function(e){return console.log(e)})}return e.prototype.start=function(){return i.__awaiter(this,void 0,void 0,function(){var e=this;return i.__generator(this,function(t){return[2,new Promise(function(t){e.clearCanvas(),e.loadFile(a.config.storyPath).then(function(){for(var n=[0,e.scene.length],o=n[0],i=n[1];o<i;o++)e.setScene(o),e.renderScene(o);e.scene=[],t()}).catch(function(){l.EditorEventHandler.addNewScene(),t()})})]})})},e.prototype.loadFile=function(e){return i.__awaiter(this,void 0,void 0,function(){var t=this;return i.__generator(this,function(n){return[2,new Promise(function(n,o){r.fileReader({url:e,type:"GET",async:!0,data:""}).then(function(e){var i=JSON.parse(e.responseText);c.Frame.headerTitle.textContent=i.title,t.scene=i.scenes,t.scene.length>0?n():o()}).catch(function(){o()})})]})})},e.prototype.clearCanvas=function(){c.Scene._=[],c.Canvas.dom.rewrite("")},e.prototype.setScene=function(e){var t=new s.ComponentCamera(this.scene[e].Camera),n=[];this.scene[e].Images.forEach(function(e){n.push(new s.ComponentImage(e,t.state[0]))});var o=[];this.scene[e].Texts.forEach(function(e){o.push(new s.ComponentText(e,t.state[0]))});var i=[];this.scene[e].Sounds.forEach(function(e){i.push(new s.ComponentSound(e))}),c.Scene.add(t,n,o,i)},e.prototype.renderScene=function(e){c.Canvas.dom.append(c.Scene._[e].dom.el);var t=document.createDocumentFragment();c.Scene._[e].Images.forEach(function(e){t.appendChild(e.element)}),c.Scene._[e].Texts.forEach(function(e){t.appendChild(e.element)}),c.Scene._[e].Sounds.forEach(function(e){t.appendChild(e.element)}),c.Scene._[e].dom.append(t)},e}();e.Main=t}(o||(o={})),t.Render=o.Main}]);